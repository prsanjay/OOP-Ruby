<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
	<title>Continuation</title>
	<link rel="stylesheet" href="includes/styles.css" type="text/css" media="all">
</head>
<body>
<div id="header">
	<h1>Programming Ruby</h1>
	<h2>The Pragmatic Programmer's Guide</h2>
</div><div id="menutop" class="menu">
	
	<a href="frameset.html" class="contents" target="_top">^Contents^</a>
</div><script type="text/javascript">
	top.frames.toc && top.frames.toc.SyncChanges && top.frames.toc.SyncChanges(null,'ref_c_continuation',location.hash);
	top.document.title=document.title+' @ Programming Ruby';
</script>


<h1 class="class" id="Continuation">class <strong>Continuation</strong> &lt; Object</h1>

<p><code class="class">Continuation</code> objects are generated by   <code class="module_instance_method"><a href="ref_m_kernel.html#Kernel.callcc"><span class="module">Kernel</span>#<span class="method">callcc</span></a></code>. They hold a return address and execution   context, allowing a nonlocal return to the end of the <code>callcc</code> block from anywhere within a program. Continuations are somewhat analogous to a structured version of C's <code>setjmp/longjmp</code> (although they contain more state, so you might consider them closer to threads).</p>

<p>For instance:</p>

<div><code class="block">arr = [ "Freddie", "Herbie", "Ron", "Max", "Ringo" ]
callcc{|$cc|}
puts(message = arr.shift)
$cc.call unless message =~ /Max/</code></div>
<p class="produces"><em>produces:</em></p>
<div><code class="block">Freddie
Herbie
Ron
Max</code></div>

  This (somewhat contrived) example  allows the inner loop to abandon
  processing early:

<div><code class="block">callcc {|cont|
  for i in 0..4
    print "\n#{i}: "
    for j in i*5...(i+1)*5
      cont.call() if j == 17
      printf "%3d", j
    end
  end
}
print "\n"</code></div>
<p class="produces"><em>produces:</em></p>
<div><code class="block">
0:   0  1  2  3  4
1:   5  6  7  8  9
2:  10 11 12 13 14
3:  15 16</code></div>

<h2 class="refsubsection" id="instancemethods">instance methods</h2>
<dl class="methodlist">
	<dt id="Continuation.call">call</dt>
		<dd class="callseq"><i class="obj">cont</i>.call( <i>[</i><i class="obj">args</i><i>]*</i> )</dd>
		<dd class="desc">Invokes the continuation. The program continues from the end of
      the <code>callcc</code> block. If no arguments are given, the original
      <code class="method">callcc</code> returns <code class="const">nil</code>. If one argument is given,
      <code class="method">callcc</code> returns it. Otherwise, an array containing
      <i class="obj">args</i> is returned.

<div><code class="block">callcc {|cont|  cont.call } <span class="output"><span class="outputmark">&rarr;</span> nil</span>
callcc {|cont|  cont.call 1 } <span class="output"><span class="outputmark">&rarr;</span> 1</span>
callcc {|cont|  cont.call 1, 2, 3 } <span class="output"><span class="outputmark">&rarr;</span> [1, 2, 3]</span></code></div></dd>
</dl>

<div id="menubot" class="menu">
	
	<a href="frameset.html" class="contents" target="_top">^Contents^</a>
</div>

<div id="copyright">
	<p>Extracted from the book "Programming Ruby -  The Pragmatic Programmer's Guide"</p>
	<p>Copyright &copy; 2001 by Addison Wesley Longman, Inc. This material may be distributed only subject to the terms and conditions set forth in the Open Publication License, v1.0 or later (the latest version is presently available at <a href="http://www.opencontent.org/openpub/">http://www.opencontent.org/openpub/</a>).</p>
	<p>Distribution of substantively modified versions of this document is prohibited without the explicit permission of the copyright holder.</p>
	<p>Distribution of the work or derivative of the work in any standard (paper) book form is prohibited unless prior permission is obtained from the copyright holder.</p>
</div>

<a href="ref_c_continuation.html" target="_top" id="expand" title="Show this content in its own window" onclick="this.href=window.location.href"><img src="includes/expand.png" alt="Show this content in its own window" width="15" height="15"></a>
<script type="text/javascript">
	if (top==self && document.getElementById){
		ex = document.getElementById('expand');
		img = ex.getElementsByTagName('img')[0];
		ex.title=img.alt="Show this content alongside the Table of Contents";
		ex.onclick=function(){ return true }
		ex.href="frameset.html?content="+escape(self.location.href);
		img.src="includes/collapse.png";
	}
</script>
</body>
</html>
